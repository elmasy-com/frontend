<div class="content">

  <form class="form">
    <label for="domain">Domain name:</label>
    <input id="domain" type="text" [(ngModel)]="domain" name="domain" placeholder="Domain name">
    <label for="port">Port:</label>
    <input id="port" type="text" name="port" value="443" placeholder="Port">
    <label for="protocol">Protocol:</label>
    <select name="protocol" id="protocol">
      <option value="tcp">TCP</option>
      <option value="udp">UDP</option>
    </select>
    <button (click)="scan()">Scan</button>
  </form>

  <ng-container *ngIf="(loading$ | async) === false; else loading">
    <ng-container *ngIf="response$ | async as response">
      <ng-container *ngIf="response.length">

        <div class="report-list" *ngFor="let scanReport of response">
          <div class="report">
            <h3>Target: {{scanReport.target}} ({{ domain }})</h3>
            <div class="tls-list">
              <div class="tls" *ngFor="let tls of scanReport.tls">
                <h4>{{tls.version}}</h4>
                <h5>Supported: {{tls.supported}}</h5>
                <ng-container *ngIf="tls.ciphers?.length">
                  <h5>Ciphers: </h5>
                  <div class="ciphers">
                    <ul class="cipher-list">
                      <li class="cipher-list-item" *ngFor="let cipher of tls.ciphers">
                        <span class="cipher-security" [ngClass]="cipher.Security">{{ cipher.Security | titlecase }}</span><span>{{ cipher.Name }}</span>
                      </li>
                    </ul>
                  </div>
                </ng-container>
              </div>
            </div>
          </div>
        </div>

      </ng-container>
    </ng-container>
  </ng-container>
</div>

<ng-template #loading>
  <div class="loading">
    <app-loading-spinner></app-loading-spinner>
  </div>
</ng-template>

<ng-template #error>
  <div class="report-list">
    <h3>Empty</h3>
  </div>
</ng-template>
